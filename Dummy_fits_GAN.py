from random import random
from matplotlib import pyplot as plt
import math
import numpy as np
import uproot
from matplotlib import ticker

def gauss( x, A, u, sigma ):
    return  A * np.exp(-np.power(x - u, 2) / (2 * np.power(sigma, 2)))

def gaussian_regression( X_data, Y_data):
    #Hongwei G., A simple algorithm for fitting a gaussian function,
    #IEEE Signal Processing Magazine 28(5) 2011

    sumX, sumX2, sumX3, sumX4, sumlogY, sumXlogY, sumX2logY = 0, 0, 0, 0, 0, 0, 0
    a, b, c = 0, 0, 0
    Y_dat = list(Y_data)

    for i in range(len(X_data)):
        Y_dat[i] = math.log(Y_data[i])

        sumX = sumX + X_data[i]
        sumX2 = sumX2 + math.pow(X_data[i],2)
        sumX3 = sumX3 + math.pow(X_data[i], 3)
        sumX4 = sumX4 + math.pow(X_data[i], 4)
        sumlogY = sumlogY + Y_dat[i]
        sumXlogY = sumXlogY + X_data[i] * Y_dat[i]
        sumX2logY = sumX2logY + math.pow(X_data[i],2) * Y_dat[i]


    M = np.array( [ [len(X_data), sumX, sumX2], [sumX, sumX2, sumX3], [sumX2, sumX3, sumX4] ] )
    X = np.array( [sumlogY, sumXlogY, sumX2logY] )
    pol_coeffs = np.linalg.inv(M).dot(X)

    A = math.exp( pol_coeffs[0] - math.pow(pol_coeffs[1],2)/(4 * pol_coeffs[2]) )
    u = - pol_coeffs[1] / (2 * pol_coeffs[2])
    pol_coeffs[2] =  - abs(pol_coeffs[2])
    sigma = math.sqrt( - 1 / (2 * pol_coeffs[2]) )

    return [A, u, sigma]

def gauss_genetic_optimization(X_data, Y_data):

    N = 50;
    number_of_steps = len(X_data)
    params = 3

    vec, vec2 = list(range(N * params)), list(range(N * params))
    cost, cost2 = list(range(N)), list(range(N))

    # agents initialization
    for i in range(N):
        vec[i] = 5000 + 5000*( random() -0.5)
        vec[i + N] = 5 * random()
        vec[i + 2*N] = 0.3 * random()


    cost = calculate_cost(X_data, Y_data, vec);

    for loop in range(600):
        for j in range(N):
            e = 2 * random() - 1
            z1 = round((N - 1) * random())
            z2 = round((N - 1) * random())
            vec2[j] = vec[j] + e * (vec[z1] - vec[z2])
            vec2[j + N] = vec[j + N] + e * (vec[z1 + N] - vec[z2 + N])
            vec2[j + 2*N] = vec[j + 2*N] + e * (vec[z1 + 2*N] - vec[z2 + 2*N])

            vec2[j] = apply_boundary(0, 55000, vec2[j]);
            vec2[j + N] = apply_boundary(0, 50, vec2[j + N]);
            vec2[j + 2*N] = apply_boundary(0, 25, vec2[j + 2*N]);

        cost2 = calculate_cost(X_data, Y_data, vec2)

        for j in range(N):
            if cost2[j] < cost[j]:
                vec[j] = vec2[j]
                vec[j + N] = vec2[j + N]
                vec[j + 2*N] = vec2[j + 2*N]
                cost[j] = cost2[j]

    cost2 = calculate_cost(X_data, Y_data, vec)

    best_solution = cost2.index(min(cost2))

    return vec[best_solution], vec[best_solution + N], vec[best_solution + 2*N]


def calculate_cost(X_data, Y_data, agents):
    Calculated_cost = 0
    cost = []
    N = int(len(agents)/3)
    for i in range(N):
        Calculated_cost = 0
        for k in range(len(X_data)):
            Calculated_cost = Calculated_cost + math.pow( gauss(X_data[k], agents[i],
                                agents[i + N], agents[i + 2*N]) - Y_data[k], 2);

        cost.append(Calculated_cost)

    return cost

def apply_boundary(min, max, value):
    result = 0
    if value < min :
        result = min + 0.01 * (max - min) * random()
    elif value > max :
        result = max - 0.01 * (max - min) * random()
    else :
        result = value

    return result



def gaussian_method_of_moments( X_data, Y_data ):

    #print(Y_data)
    u, sigma = 0, 0
    sumY = 0
    for i in range(len(X_data)):
        sumY = sumY + Y_data[i]

    sumY = sumY * (max(X_data) - min(X_data))/ len(Y_data)


    for i in range(len(X_data)):
        u = u + X_data[i] * Y_data[i] / sumY

    for i in range(len(X_data)):
        sigma = sigma + ( math.pow(X_data[i] - u ,2) * Y_data[i] ) / sumY
    sigma = math.sqrt(sigma)
    A = sumY * ( 1/(sigma*np.sqrt(2*np.pi)) )

    return [A, u, sigma]


def main():

    file = uproot.open("files/BKKK_sample3.root")
    events = file["DecayTree"]
    print(events.keys())
    NumEntries = events.numentries  # number of data objects (vectors)
    #params = ["H1_PX", "H1_PY", "H1_PZ", "H2_PX", "H2_PY", "H2_PZ", "H3_PX", "H3_PY", "H3_PZ"]
    params = ["B_M"]
    Mass_K = 493.677 / 1000
    batch_size = 10000

    data = events.lazyarrays(params)
    data_arr = np.vstack(list(data[elem] for elem in params)).T
    Mass_B = np.zeros(NumEntries)

    hist, bin_edges = np.histogram(data_arr)

    fig, ax = plt.subplots(1,1, figsize=(6,5))
    n, bins, patches = ax.hist(data_arr, 80, range = [5.15,5.4], histtype='step', alpha=1, color='k', linewidth = 1.6, label=r'$B_0$ mass')
    ax.set_xlabel(r'$B_0$ mass [GeV]', fontsize=11)
    ax.set_ylabel('Counts', fontsize=11)
    ax.set_xlim([5.15,5.4])
    bins = bins[:-1]
    bins = bins + (bins[2] - bins[1])

    ax.ticklabel_format(axis='y',style="sci", scilimits=(0,0))

    A_opt, u_opt, sigma_opt = gauss_genetic_optimization(bins, n)
    print("Differential optimization:")
    print("A: ",A_opt,", mean: ", u_opt,", sigma: ", sigma_opt)
    print("Maximum likelihood: ", np.mean(data_arr))
    X_opt = np.linspace(5.,5.6,501)
    Y_opt = [ gauss(x_point, A_opt, u_opt, sigma_opt) for x_point in X_opt]
    ax.plot(X_opt, Y_opt, 'r', label = "DE-optimized fit", linewidth = 2)
    ax.tick_params(axis='x', labelsize=11)
    ax.tick_params(axis='y', labelsize=11)
    #leg = ax.legend(loc = 'upper left', fontsize  = 9)
    leg = ax.legend(loc = 'upper left', fontsize=11)

    #plt.show()

    B_ganned = np.array([5.186871 , 5.1292973, 5.2448196, 5.1475234, 5.2572894, 5.1821456,       5.10301  , 5.2284117, 5.2511134, 5.1516213, 5.3063655, 5.32774  ,       5.2147346, 5.4121475, 5.298316 , 5.387074 , 5.322257 , 5.2535353,
       5.3282924, 5.3294992, 5.357377 , 5.4225783, 5.292312 , 5.1351166,       5.2382793, 5.2071557, 5.155709 , 5.42731  , 5.1858215, 5.4865503,
       5.0927672, 5.2757735, 5.176221 , 5.298084 , 5.145921 , 5.3978453,       5.2925577, 5.314315 , 5.390309 , 5.3053565, 5.288947 , 5.4495974,       5.173086 , 5.169819 , 5.263591 , 5.3051643, 5.5493627, 5.2854834,
       5.1538587, 5.2487826, 5.598446 , 5.0987177, 5.116085 , 5.476069 ,
       5.221745 , 5.4230843, 5.2724166, 5.152956 , 5.439184 , 5.3066983,
       5.4301314, 5.3881717, 5.496136 , 5.290189 , 5.1472325, 5.092236 ,
       5.5381618, 5.1667295, 5.235825 , 5.2793703, 5.2196846, 5.1747184,       5.236116 , 5.0923276, 5.559014 , 5.2160864, 5.204037 , 5.259689 ,
       5.389222 , 5.40713  , 5.095405 , 5.155204 , 5.213834 , 5.280899 ,       5.136847 , 5.38032  , 5.074809 , 5.5321875, 5.159153 , 5.1702666,
       5.250079 , 5.3009553, 5.532428 , 5.370661 , 5.5078974, 5.3891234,
       5.224088 , 5.29285  , 5.333778 , 5.3993945, 5.144429 , 5.395708 ,       5.310348 , 5.427308 , 5.4117002, 5.3988347, 5.3656135, 5.491918 ,
       5.6217723, 5.301154 , 5.103754 , 5.2742696, 5.5885234, 5.131556 ,
       5.245015 , 5.1510925, 5.146746 , 5.226971 , 5.1387568, 5.1837244,       5.147113 , 5.293823 , 5.139434 , 5.23637  , 5.1580906, 5.2943697,      5.454805 , 5.597682 , 5.346147 , 5.517588 , 5.2751126, 5.2219496,
       5.457409 , 5.5413914, 5.157237 , 5.3261395, 5.172591 , 5.206515 ,       5.2605906, 5.3968883, 5.436742 , 5.2763295, 5.532731 , 5.159239 ,
       5.5705504, 5.470835 , 5.5167704, 5.3880596, 5.1568675, 5.175385 ,
       5.385807 , 5.1585464, 5.5496974, 5.2966485, 5.3951616, 5.287212 ,
       5.349693 , 5.500852 , 5.1524143, 5.171331 , 5.242775 , 5.136879 ,
       5.146622 , 5.312753 , 5.3970156, 5.295164 , 5.2553344, 5.197148 ,
       5.244032 , 5.2570834, 5.4522247, 5.2642727, 5.2841496, 5.260529 ,
       5.312926 , 5.287037 , 5.106609 , 5.246422 , 5.149907 , 5.1634135,
       5.1594005, 5.3158927, 5.4290285, 5.349698 , 5.2600594, 5.162696 ,
       5.5986047, 5.1585298, 5.526525 , 5.325711 , 5.4364147, 5.1511974,
       5.2386208, 5.457049 , 5.3426404, 5.350107 , 5.467794 , 5.4627748,
       5.3002033, 5.2043505, 5.3267474, 5.4021907, 5.3241963, 5.1798387,
       5.147152 , 5.2490964, 5.1915555, 5.3616266, 5.1486535, 5.2261324,
       5.415714 , 5.399664 , 5.147607 , 5.228764 , 5.2022724, 5.1631804,
       5.160248 , 5.296222 , 5.3977995, 5.1611943, 5.248668 , 5.150668 ,
       5.223284 , 5.39371  , 5.1342783, 5.223331 , 5.4519005, 5.1337695,
       5.2079525, 5.120827 , 5.38745  , 5.2138424, 5.4224114, 5.171904 ,
       5.26691  , 5.2217045, 5.396014 , 5.2908688, 5.3075852, 5.4595366,
       5.334702 , 5.184945 , 5.214101 , 5.31733  , 5.3678055, 5.119684 ,
       5.5488634, 5.473002 , 5.1221185, 5.222955 , 5.3033557, 5.3256664,
       5.564905 , 5.314361 , 5.2304688, 5.205449 , 5.150699 , 5.489258 ,
       5.154053 , 5.3585486, 5.436349 , 5.1749377, 5.3788714, 5.6062655,
       5.2305026, 5.400046 , 5.238334 , 5.4063907, 5.2037797, 5.464319 ,
       5.1441846, 5.2587504, 5.279716 , 5.2547374, 5.214694 , 5.3331084,
       5.246651 , 5.482879 , 5.1529937, 5.1226997, 5.141499 , 5.1878614,
       5.2866216, 5.329156 , 5.1798034, 5.1523666, 5.082188 , 5.380194 ,
       5.3488836, 5.4019775, 5.278601 , 5.283983 , 5.1440887, 5.426676 ,
       5.1497226, 5.333289 , 5.148569 , 5.304733 , 5.304249 , 5.08608  ,
       5.3544054, 5.354231 , 5.219522 , 5.177197 , 5.260038 , 5.4533606,       5.179637 , 5.181069 , 5.2835746, 5.0747414, 5.183208 , 5.428082 ,
       5.0779085, 5.1923947, 5.169234 , 5.2973514, 5.184662 , 5.1502223,       5.249435 , 5.155343 , 5.2601814, 5.1353226, 5.41516  , 5.211285 ,
       5.319231 , 5.14519  , 5.3415112, 5.5091143, 5.1673346, 5.190543 ,
       5.2284236, 5.1902456, 5.388143 , 5.37693  , 5.40592  , 5.4305   ,       5.354742 , 5.155827 , 5.387897 , 5.370691 , 5.4457273, 5.13745  ,
       5.042588 , 5.1469207, 5.3771973, 5.3160086, 5.29003  , 5.215712 ,
       5.5163703, 5.3155913, 5.4827757, 5.3983474, 5.256148 , 5.414263 ,       5.4906354, 5.253973 , 5.2263203, 5.3168035, 5.3707294, 5.1604085,
       5.172665 , 5.0489283, 5.284236 , 5.15383  , 5.5498347, 5.497234 ,
       5.1843796, 5.395435 , 5.1672373, 5.4373956, 5.4932747, 5.245088 ,       5.465823 , 5.2190027, 5.328221 , 5.1964374, 5.34735  , 5.161906 ,
       5.22778  , 5.1482964, 5.283343 , 5.23793  , 5.3310375, 5.130693 ,       5.2007575, 5.404669 , 5.1982946, 5.225736 , 5.29179  , 5.3046007,
       5.152309 , 5.127323 , 5.3231397, 5.344413 , 5.190925 , 5.4515862,
       5.2850714, 5.3376713, 5.174278 , 5.2961764, 5.188247 , 5.3626003,
       5.1575437, 5.190656 , 5.577309 , 5.408881 , 5.508757 , 5.150549 ,
       5.289351 , 5.4058194, 5.5257673, 5.1585712, 5.545671 , 5.178969 ,
       5.297372 , 5.1709566, 5.1947355, 5.282661 , 5.3073974, 5.395232 ,
       5.205015 , 5.1581163, 5.178952 , 5.2611303, 5.1765385, 5.1343436,
       5.273234 , 5.229601 , 5.1866283, 5.4464364, 5.2365136, 5.173066 ,
       5.3303432, 5.191175 , 5.284588 , 5.4662843, 5.150385 , 5.092005 ,
       5.5700855, 5.344599 , 5.337529 , 5.219296 , 5.6012297, 5.2651258,
       5.5117846, 5.1642776, 5.2123933, 5.1035533, 5.308125 , 5.4145284,
       5.4882054, 5.259922 , 5.1908736, 5.3140783, 5.2300625, 5.2731776,
       5.158807 , 5.4827056, 5.351437 , 5.1567626, 5.3717613, 5.344476 ,
       5.4620442, 5.1139474, 5.1518064, 5.261588 , 5.2509456, 5.1955724,
       5.2269845, 5.209169 , 5.257752 , 5.147893 , 5.205741 , 5.1555862,
       5.529471 , 5.3322706, 5.170026 , 5.1485643, 5.129321 , 5.3676047,
       5.378494 , 5.312734 , 5.524838 , 5.4237556, 5.2578363, 5.29135  ,
       5.210995 , 5.1821313, 5.2637434, 5.3170185, 5.1368217, 5.1301622,
       5.335353 , 5.3013763, 5.2264194, 5.352498 , 5.166541 , 5.1739902,
       5.1375227, 5.399126 , 5.4171534, 5.2485647, 5.1985617, 5.172259 ,
       5.2612786, 5.168921 , 5.181552 , 5.442734 , 5.2920094, 5.369737 ,
       5.5863404, 5.496978 , 5.1927094, 5.160478 , 5.15863  , 5.384247 ,
       5.2693663, 5.1895423, 5.088001 , 5.6056285, 5.238869 , 5.151409 ,
       5.257598 , 5.4654965, 5.18     , 5.217747 , 5.396876 , 5.52062  ,
       5.159267 , 5.2934613, 5.2927556, 5.2035217, 5.4236765, 5.1560793,
       5.173292 , 5.1492558, 5.401288 , 5.111125 , 5.355023 , 5.153913 ,
       5.26833  , 5.2054906, 5.4904222, 5.153472 , 5.2365313, 5.294757 ,
       5.118854 , 5.1970906, 5.4968166, 5.3219657, 5.199532 , 5.346617 ,
       5.2989087, 5.2137356, 5.3271146, 5.175693 , 5.2966266, 5.1094766,
       5.277159 , 5.266238 , 5.4790225, 5.201064 , 5.4655814, 5.356921 ,
       5.17693  , 5.442738 , 5.199064 , 5.1737094, 5.30504  , 5.147945 ,
       5.401227 , 5.1553583, 5.304002 , 5.154509 , 5.142764 , 5.307646 ,
       5.2463284, 5.292779 , 5.1213083, 5.268669 , 5.250283 , 5.3507786,
       5.1622252, 5.2500334, 5.223761 , 5.401621 , 5.2702127, 5.4554806,
       5.495779 , 5.1257973, 5.3249846, 5.1173706, 5.190499 , 5.236335 ,
       5.148046 , 5.153011 , 5.273078 , 5.4531865, 5.5236406, 5.202322 ,
       5.3731775, 5.145655 , 5.3120723, 5.3224173, 5.2645497, 5.3022676,
       5.15889  , 5.2974615, 5.3636966, 5.2467637, 5.283612 , 5.136725 ,
       5.145045 , 5.238413 , 5.2028756, 5.292457 , 5.490021 , 5.252407 ,
       5.425461 , 5.3746057, 5.136382 , 5.0683227, 5.158569 , 5.438896 ,
       5.4567165, 5.294596 , 5.173913 , 5.126812 , 5.1549773, 5.370507 ,
       5.1609373, 5.4754725, 5.3190665, 5.3493366, 5.0933185, 5.291706 ,
       5.3981023, 5.3682566, 5.3763843, 5.388586 , 5.3298306, 5.514925 ,
       5.459924 , 5.118273 , 5.164727 , 5.4277754, 5.4465675, 5.294832 ,
       5.133395 , 5.1051555, 5.29525  , 5.277615 , 5.148584 , 5.151817 ,
       5.323383 , 5.328233 , 5.3398576, 5.3033924, 5.6234236, 5.254993 ,
       5.5442057, 5.365753 , 5.5057154, 5.2915983, 5.3278294, 5.4514713,
       5.1653113, 5.2685194, 5.465811 , 5.330707 , 5.3523784, 5.137688 ,
       5.3670864, 5.1070395, 5.4498706, 5.3698378, 5.2558484, 5.120448 ,
       5.4154277, 5.4158044, 5.316761 , 5.5011506, 5.367458 , 5.3933415,
       5.2600827, 5.193015 , 5.5880547, 5.4158382, 5.199957 , 5.3446727,
       5.285193 , 5.2073026, 5.1842804, 5.3018956, 5.3490443, 5.4580107,
       5.136239 , 5.1297727, 5.333326 , 5.2960124, 5.538709 , 5.3348002,
       5.598974 , 5.19894  , 5.292203 , 5.130229 , 5.1858106, 5.2533803,
       5.465245 , 5.25469  , 5.1784334, 5.1449995, 5.256293 , 5.329519 ,
       5.405113 , 5.2818317, 5.202862 , 5.2352424, 5.3623905, 5.2855344,
       5.310455 , 5.278105 , 5.3009706, 5.2023926, 5.1394305, 5.384994 ,
       5.157566 , 5.1258903, 5.128056 , 5.2662287, 5.406495 , 5.400792 ,
       5.5714316, 5.1910315, 5.2789683, 5.576645 , 5.1885624, 5.151431 ,
       5.198764 , 5.1535463, 5.208977 , 5.2906814, 5.3807507, 5.3346786,
       5.2584505, 5.475325 , 5.2843814, 5.2822633, 5.5035367, 5.1562624,
       5.212151 , 5.370424 , 5.1398973, 5.2975154, 5.2554545, 5.419713 ,
       5.1575356, 5.496943 , 5.1508737, 5.141654 , 5.1100516, 5.1658435,
       5.2793107, 5.1846375, 5.253417 , 5.2770276, 5.162782 , 5.309671 ,
       5.206993 , 5.165081 , 5.1742268, 5.2339425, 5.381881 , 5.426785 ,
       5.2910504, 5.2678037, 5.2227035, 5.1695123, 5.4013076, 5.1684175,
       5.47773  , 5.4036145, 5.17944  , 5.335211 , 5.3534155, 5.197834 ,
       5.4883246, 5.321741 , 5.290436 , 5.265426 , 5.2169166, 5.1691413,
       5.1490717, 5.125605 , 5.1984224, 5.1224566, 5.283549 , 5.1511664,
       5.3384223, 5.293221 , 5.2831874, 5.2498283, 5.0918727, 5.1963596,
       5.560429 , 5.2667136, 5.413251 , 5.0480127, 5.1327887, 5.4887457,
       5.139784 , 5.131257 , 5.171644 , 5.2642   , 5.294642 , 5.2841268,
       5.2539167, 5.3361244, 5.1503315, 5.531032 , 5.2639995, 5.275827 ,
       5.1351485, 5.1459603, 5.1588264, 5.25674  , 5.248218 , 5.4586887,
       5.623773 , 5.1519723, 5.4242816, 5.2545156, 5.388945 , 5.1912694,
       5.190446 , 5.1028147, 5.1258307, 5.134972 , 5.1813965, 5.2905197,
       5.5026197, 5.2417955, 5.351882 , 5.0766997, 5.214432 , 5.351717 ,
       5.3065915, 5.149758 , 5.620974 , 5.2239437, 5.2183657, 5.5141473,
       5.400839 , 5.1265926, 5.450407 , 5.204869 , 5.186338 , 5.3515453,
       5.293743 , 5.44834  , 5.2088013, 5.5039234, 5.556706 , 5.274591 ,
       5.3455977, 5.1942344, 5.175579 , 5.1591244, 5.3216143, 5.5258803,
       5.4362807, 5.139689 , 5.507794 , 5.1573896, 5.249776 , 5.295838 ,
       5.1459584, 5.4527564, 5.263214 , 5.255728 , 5.465707 , 5.1452312,
       5.1406164, 5.14937  , 5.1723037, 5.196539 , 5.277709 , 5.5016465,
       5.242297 , 5.504038 , 5.2799673, 5.273689 , 5.573685 , 5.29326  ,
       5.1716337, 5.1856685, 5.2034802, 5.4303193, 5.2055044, 5.4585896,
       5.3570414, 5.175399 , 5.407157 , 5.054518 , 5.1817703, 5.359738 ,
       5.23061  , 5.518569 , 5.173316 , 5.589912 , 5.1727386, 5.1980295,
       5.2390103, 5.1643887, 5.194636 , 5.2176695, 5.288301 , 5.2801766,
       5.132885 , 5.394135 , 5.1565447, 5.492731 , 5.4800916, 5.213065 ,
       5.4107914, 5.504642 , 5.4799366, 5.2329097, 5.2189255, 5.2635326,
       5.156732 , 5.4337573, 5.3123646, 5.1808543, 5.3877945, 5.209669 ,
       5.2285705, 5.173436 , 5.1519775, 5.351291 , 5.29679  , 5.1592255,
       5.1477337, 5.555303 , 5.2508903, 5.183801 , 5.1515303, 5.325935 ,
       5.4302864, 5.2491546, 5.303403 , 5.282569 , 5.2828026, 5.216747 ,
       5.5792847, 5.1478887, 5.345603 , 5.258971 , 5.3073263, 5.141429 ,
       5.222085 , 5.351366 , 5.175395 , 5.4058323, 5.4290833, 5.4634085,
       5.143056 , 5.1182637, 5.206555 , 5.390913 , 5.3247757, 5.4078116,
       5.1516404, 5.4254475, 5.1655574, 5.29849  , 5.1895947, 5.4936624,
       5.2947574, 5.251068 , 5.4023314, 5.1180367, 5.144615 , 5.219727 ,
       5.2812567, 5.4341383, 5.401963 , 5.1576695, 5.1466513, 5.149598 ,
       5.223844 , 5.1406503, 5.195984 , 5.3165   , 5.2911863, 5.22181  ,
       5.301511 , 5.274862 , 5.2518306, 5.284905 ])

    #hist, bin_edges = np.histogram(B_ganned)

    fig, ax = plt.subplots(1,1, figsize=(6,5))
    n, bins, patches = ax.hist(B_ganned, 80, range = [5.15,5.4], histtype='step', alpha=1, color='k', linewidth = 1.6, label=r'$B_0$ mass')
    ax.set_xlabel(r'$B_0$ mass [GeV]', fontsize=11)
    ax.set_ylabel('Counts', fontsize=11)
    ax.set_xlim([5.15,5.4])
    bins = bins[:-1]
    bins = bins + (bins[2] - bins[1])

    ax.ticklabel_format(axis='y',style="sci", scilimits=(0,0))

    A_opt, u_opt, sigma_opt = gauss_genetic_optimization(bins, n)
    print("Differential optimization:")
    print("A: ",A_opt,", mean: ", u_opt,", sigma: ", sigma_opt)
    print("Maximum likelihood: ", np.mean(data_arr))
    X_opt = np.linspace(5.,5.6,501)
    Y_opt = [ gauss(x_point, A_opt, u_opt, sigma_opt) for x_point in X_opt]
    ax.plot(X_opt, Y_opt, 'r', label = "DE-optimized fit", linewidth = 2)
    ax.tick_params(axis='x', labelsize=11)
    ax.tick_params(axis='y', labelsize=11)
    #leg = ax.legend(loc = 'upper left', fontsize  = 9)
    leg = ax.legend(loc = 'upper left', fontsize=11)

    plt.show()

    B_ganned2 = [5.3038464, 5.284788 , 5.3009768, 5.2519717, 5.2845693, 5.2885337,
       5.293654 , 5.2901573, 5.254591 , 5.2791123, 5.310961 , 5.2939215,
       5.2464013, 5.302781 , 5.261274 , 5.2745013, 5.2931223, 5.3036566,
       5.24169  , 5.302774 , 5.289591 , 5.259732 , 5.28933  , 5.298013 ,
       5.2792735, 5.281052 , 5.2977495, 5.2760496, 5.2808037, 5.2733126,
       5.285113 , 5.2954903, 5.2957826, 5.2478795, 5.245674 , 5.2385917,
       5.2911744, 5.2822742, 5.265981 , 5.2855673, 5.2925606, 5.293272 ,
       5.2998214, 5.3044767, 5.2650266, 5.2928987, 5.288595 , 5.291678 ,
       5.2868056, 5.295541 , 5.28549  , 5.295541 , 5.275808 , 5.280761 ,
       5.28034  , 5.2393703, 5.258604 , 5.243618 , 5.275212 , 5.243026 ,
       5.269914 , 5.2501287, 5.2968516, 5.253643 , 5.2539387, 5.2383733,
       5.281781 , 5.280054 , 5.271301 , 5.2496324, 5.295351 , 5.2594886,
       5.308919 , 5.2921467, 5.271502 , 5.3064175, 5.28684  , 5.2748365,
       5.278729 , 5.2739086, 5.28624  , 5.257115 , 5.243915 , 5.2928686,
       5.239554 , 5.289536 , 5.253045 , 5.2837777, 5.268365 , 5.266135 ,
       5.309792 , 5.29674  , 5.2387033, 5.304305 , 5.2581344, 5.2835293,
       5.308412 , 5.3030977, 5.3036714, 5.2950644, 5.295001 , 5.2538714,
       5.2959414, 5.302922 , 5.2802386, 5.2822313, 5.255775 , 5.2642455,
       5.276737 , 5.2830873, 5.242858 , 5.2982745, 5.2934227, 5.2848463,
       5.2732887, 5.256195 , 5.295748 , 5.2736616, 5.30519  , 5.2836967,
       5.275119 , 5.2711167, 5.2999783, 5.2942405, 5.2418633, 5.2739143,
       5.2428904, 5.2963667, 5.292435 , 5.2547655, 5.30051  , 5.30221  ,
       5.2777166, 5.3020782, 5.2740245, 5.2695494, 5.287673 , 5.270342 ,
       5.2484264, 5.2517295, 5.2706056, 5.286001 , 5.24313  , 5.279834 ,
       5.273743 , 5.296367 , 5.3055606, 5.24848  , 5.262012 , 5.269511 ,
       5.274182 , 5.285532 , 5.291838 , 5.30875  , 5.3054194, 5.2485857,
       5.292835 , 5.2453613, 5.3127003, 5.257837 , 5.2706904, 5.2894473,
       5.2877703, 5.279314 , 5.2996006, 5.2831583, 5.2950315, 5.2778425,
       5.308539 , 5.2688103, 5.303321 , 5.2478447, 5.2709455, 5.3081794,
       5.3027086, 5.2960496, 5.267605 , 5.3097796, 5.2837386, 5.296176 ,
       5.2857327, 5.286957 , 5.249232 , 5.29301  , 5.2976975, 5.288689 ,
       5.2940154, 5.2610116, 5.2861514, 5.2672477, 5.2815757, 5.262111 ,
       5.303201 , 5.3063617, 5.2939696, 5.3036304, 5.2796607, 5.288788 ,
       5.242658 , 5.3012843, 5.279562 , 5.288493 , 5.285777 , 5.269872 ,
       5.2406693, 5.3039274, 5.2984476, 5.301637 , 5.3059754, 5.274298 ,
       5.3089356, 5.304356 , 5.266924 , 5.3075113, 5.2807803, 5.244213 ,
       5.282484 , 5.303771 , 5.2733073, 5.2857594, 5.265099 , 5.3042116,
       5.280788 , 5.2577205, 5.2477417, 5.278131 , 5.276962 , 5.27251  ,
       5.273927 , 5.2580466, 5.256932 , 5.298681 , 5.3035383, 5.290127 ,
       5.3031015, 5.298187 , 5.2901044, 5.2852073, 5.299176 , 5.2655644,
       5.284706 , 5.2929683, 5.2751794, 5.295591 , 5.244934 , 5.293804 ,
       5.2688627, 5.3045382, 5.3067183, 5.285493 , 5.2462544, 5.2745814,
       5.286244 , 5.3025937, 5.2940974, 5.2604947, 5.3089123, 5.2972445,
       5.281405 , 5.2835855, 5.2500052, 5.300829 , 5.292377 , 5.286968 ,
       5.3025184, 5.2446804, 5.2926188, 5.299631 , 5.2880454, 5.257422 ,
       5.26125  , 5.2874794, 5.263862 , 5.3012013, 5.2849874, 5.2553263,
       5.2583203, 5.304067 , 5.240143 , 5.2826457, 5.3096004, 5.3037324,
       5.2952147, 5.3061347, 5.250017 , 5.2773075, 5.2532883, 5.2645087,
       5.2798023, 5.3027554, 5.2953024, 5.2584496, 5.2924953, 5.2662063,
       5.2785225, 5.309836 , 5.2928815, 5.255521 , 5.291601 , 5.2840176,
       5.291801 , 5.267642 , 5.304585 , 5.304019 , 5.294415 , 5.294347 ,
       5.244788 , 5.265278 , 5.2537203, 5.252458 , 5.3017187, 5.282522 ,
       5.239761 , 5.300182 , 5.3092895, 5.254582 , 5.304583 , 5.304502 ,
       5.2388453, 5.2464705, 5.243049 , 5.2961297, 5.2988153, 5.299667 ,
       5.3043885, 5.2449117, 5.253547 , 5.2654867, 5.286248 , 5.275052 ,
       5.2753444, 5.252818 , 5.281972 , 5.259157 , 5.29046  , 5.2725677,
       5.2673965, 5.3064795, 5.2437773, 5.290183 , 5.280608 , 5.29183  ,
       5.294151 , 5.305595 , 5.2972493, 5.2978263, 5.3019986, 5.269217 ,
       5.2576857, 5.286423 , 5.243822 , 5.2843843, 5.272917 , 5.2688055,
       5.2643604, 5.2992764, 5.294371 , 5.242214 , 5.310116 , 5.2906575,
       5.294807 , 5.256099 , 5.2532196, 5.2830663, 5.2735553, 5.308807 ,
       5.3030543, 5.293295 , 5.244905 , 5.28937  , 5.2669687, 5.2402215,
       5.241901 , 5.267116 , 5.2868176, 5.2986484, 5.29315  , 5.311834 ,
       5.2467375, 5.2433157, 5.298183 , 5.282598 , 5.299857 , 5.248463 ,
       5.2969112, 5.2579465, 5.3088913, 5.276868 , 5.2826915, 5.295805 ,
       5.292374 , 5.2874503, 5.306224 , 5.2715144, 5.2959924, 5.2754793,
       5.2605886, 5.3079696, 5.291534 , 5.284771 , 5.250339 , 5.276756 ,
       5.264026 , 5.280427 , 5.2868233, 5.255715 , 5.2733493, 5.2577724,
       5.2911496, 5.2475905, 5.289883 , 5.29409  , 5.276302 , 5.282058 ,
       5.2577877, 5.2482686, 5.3060946, 5.2435   , 5.287254 , 5.29493  ,
       5.2995696, 5.253117 , 5.28098  , 5.281245 , 5.29121  , 5.2901783,
       5.2663093, 5.293763 , 5.308969 , 5.2840266, 5.291922 , 5.274299 ,
       5.2763066, 5.2663255, 5.286339 , 5.241768 , 5.279842 , 5.2830787,
       5.2593527, 5.283924 , 5.263804 , 5.267599 , 5.3051186, 5.2594895,
       5.2629204, 5.249579 , 5.305595 , 5.2940526, 5.263675 , 5.2906985,
       5.2825804, 5.2928724, 5.2925625, 5.2911572, 5.3027897, 5.256981 ,
       5.2892704, 5.2610445, 5.2933464, 5.303186 , 5.3107285, 5.241001 ,
       5.286673 , 5.2855797, 5.3033843, 5.2497973, 5.276099 , 5.29551  ,
       5.2445736, 5.310805 , 5.2920275, 5.305917 , 5.2610326, 5.2580333,
       5.264232 , 5.283083 , 5.270444 , 5.302397 , 5.2805805, 5.287724 ,
       5.2993646, 5.291524 , 5.2545104, 5.2466054, 5.271819 , 5.3095083,
       5.30207  , 5.2612286, 5.304915 , 5.308383 , 5.3036714, 5.2496166,
       5.254765 , 5.265803 , 5.3069606, 5.264872 , 5.287541 , 5.2913733,
       5.2971053, 5.2745385, 5.2880483, 5.27613  , 5.259559 , 5.244949 ,
       5.308938 , 5.282793 , 5.244262 , 5.265082 , 5.2622657, 5.2811007,
       5.30143  , 5.289973 , 5.3114944, 5.275329 , 5.2579226, 5.294915 ,
       5.2848563, 5.278523 , 5.273869 , 5.2841377, 5.309177 , 5.302991 ,
       5.2817717, 5.2940245, 5.282942 , 5.257789 , 5.3021836, 5.2630663,
       5.2703233, 5.249193 , 5.302185 , 5.25068  , 5.256668 , 5.2543173,
       5.2952   , 5.304875 , 5.256727 , 5.2655854, 5.24818  , 5.297169 ,
       5.256095 , 5.294756 , 5.262529 , 5.2660246, 5.259267 , 5.2827315,
       5.2886395, 5.2672615, 5.280473 , 5.310743 , 5.2564735, 5.2692704,
       5.3039026, 5.2578216, 5.256075 , 5.2764287, 5.293506 , 5.3098693,
       5.2642283, 5.258717 , 5.2659965, 5.2842484, 5.29885  , 5.2982736,
       5.2656965, 5.3044653, 5.254211 , 5.261618 , 5.249345 , 5.2944527,
       5.274508 , 5.294743 , 5.2993813, 5.252945 , 5.2827725, 5.29839  ,
       5.2943015, 5.304047 , 5.2443748, 5.279132 , 5.2621756, 5.291942 ,
       5.239549 , 5.3038764, 5.263624 , 5.2902822, 5.2992053, 5.3031683,
       5.254506 , 5.3120184, 5.2850456, 5.2811556, 5.242112 , 5.2681303,
       5.2653165, 5.276249 , 5.2494793, 5.3111777, 5.260042 , 5.300684 ,
       5.243287 , 5.2992525, 5.2925386, 5.2618575, 5.287519 , 5.2503686,
       5.2559395, 5.2901826, 5.2617073, 5.2844663, 5.291652 , 5.2893696,
       5.29596  , 5.2910924, 5.253342 , 5.2488914, 5.312798 , 5.2571077,
       5.292418 , 5.3004975, 5.271038 , 5.3040204, 5.262239 , 5.3008213,
       5.292088 , 5.2815795, 5.2723546, 5.2992754, 5.258039 , 5.287475 ,
       5.304013 , 5.250443 , 5.2625666, 5.2792554, 5.2543807, 5.243629 ,
       5.2860446, 5.286286 , 5.256846 , 5.257973 , 5.2679796, 5.300924 ,
       5.263144 , 5.306303 , 5.276785 , 5.2938213, 5.2961698, 5.2996593,
       5.2579684, 5.3026586, 5.278227 , 5.2641525, 5.2781086, 5.2936964,
       5.309794 , 5.2897596, 5.2812624, 5.2570086, 5.2384553, 5.2675986,
       5.256349 , 5.3021026, 5.2934427, 5.2676616, 5.292236 , 5.263346 ,
       5.2859006, 5.2600727, 5.287664 , 5.252446 , 5.272701 , 5.2975154,
       5.260895 , 5.300652 , 5.2770987, 5.2989693, 5.2684813, 5.269396 ,
       5.245014 , 5.2616606, 5.2635183, 5.247263 , 5.2717543, 5.271698 ,
       5.306992 , 5.256731 , 5.261817 , 5.3096886, 5.2596507, 5.2848725,
       5.2864695, 5.281355 , 5.307024 , 5.2899694, 5.295993 , 5.288017 ,
       5.2747245, 5.2997756, 5.2918124, 5.250589 , 5.296739 , 5.2975006,
       5.3013015, 5.2474585, 5.2823415, 5.2850175, 5.2585692, 5.3054423,
       5.2504144, 5.303368 , 5.240783 , 5.2448   , 5.2875633, 5.2933497,
       5.257028 , 5.273258 , 5.2419333, 5.2937193, 5.2830524, 5.2949176,
       5.299145 , 5.3086014, 5.256867 , 5.297328 , 5.2968388, 5.2989173,
       5.29232  , 5.3053164, 5.27482  , 5.2596407, 5.2822204, 5.3024635,
       5.3103228, 5.2803807, 5.286213 , 5.2982826, 5.3073063, 5.310555 ,
       5.292396 , 5.2999587, 5.2571416, 5.283307 , 5.2556734, 5.3009644,
       5.242542 , 5.2909646, 5.2769203, 5.2915196, 5.258924 , 5.259326 ,
       5.2950387, 5.294556 , 5.2620635, 5.300214 , 5.2672486, 5.2429166,
       5.2694836, 5.2923794, 5.307472 , 5.249954 , 5.2860475, 5.3084474,
       5.2624507, 5.294026 , 5.259157 , 5.2808275, 5.2725377, 5.2732177,
       5.286553 , 5.3030167, 5.2675514, 5.255855 , 5.2821655, 5.2644157,
       5.2688775, 5.2887664, 5.307315 , 5.273009 , 5.2960405, 5.2952456,
       5.2595344, 5.2516866, 5.2518888, 5.2942944, 5.2789946, 5.2534404,
       5.272773 , 5.2758236, 5.293423 , 5.253279 , 5.304177 , 5.2428684,
       5.2752485, 5.2704215, 5.279488 , 5.288747 , 5.2988687, 5.3020463,
       5.274955 , 5.2955422, 5.3017287, 5.3019032, 5.2740955, 5.303621 ,
       5.278289 , 5.2617674, 5.2846823, 5.2412806, 5.280916 , 5.2610984,
       5.2631636, 5.2890296, 5.303722 , 5.2704034, 5.2976007, 5.293677 ,
       5.2432504, 5.297108 , 5.2805686, 5.2675524, 5.283004 , 5.27299  ,
       5.2885594, 5.2941484, 5.293722 , 5.297177 , 5.305613 , 5.308391 ,
       5.279177 , 5.294417 , 5.297906 , 5.2428985, 5.2464886, 5.2896767,
       5.303898 , 5.2795644, 5.3032804, 5.2466216, 5.287469 , 5.30745  ,
       5.3034306, 5.299916 , 5.3063846, 5.308246 , 5.271381 , 5.254725 ,
       5.303634 , 5.279399 , 5.2730536, 5.309122 , 5.262586 , 5.2806787,
       5.2624927, 5.2633367, 5.29178  , 5.26483  , 5.2679257, 5.302194 ,
       5.267572 , 5.2476125, 5.247208 , 5.270929 , 5.2933836, 5.2918067,
       5.277887 , 5.262497 , 5.2681336, 5.2791405, 5.302143 , 5.271368 ,
       5.2899737, 5.2581472, 5.2560706, 5.3047256, 5.287156 , 5.2974176,
       5.296729 , 5.2992444, 5.2991257, 5.292694 , 5.2618093, 5.3017535,
       5.2562428, 5.277579 , 5.284918 , 5.29278  , 5.2644405, 5.309538 ,
       5.2568035, 5.281979 , 5.3096447, 5.3002615, 5.302722 , 5.303783 ,
       5.2501802, 5.2421937, 5.2907157, 5.295977 , 5.2421803, 5.306458 ,
       5.306683 , 5.3086796, 5.2920365, 5.2596474, 5.299044 , 5.307999 ,
       5.304089 , 5.30918  , 5.257927 , 5.281004 , 5.2846007, 5.3088417,
       5.284743 , 5.2443047, 5.2655706, 5.2599964, 5.2736197, 5.28676  ,
       5.2778096, 5.2882133, 5.310424 , 5.2740936, 5.2715144, 5.2435045,
       5.2616625, 5.280714 , 5.2912498, 5.2790585, 5.274414 , 5.2842846,
       5.270746 , 5.302881 , 5.288265 , 5.305992 , 5.2421293, 5.28527  ,
       5.3099437, 5.3051434, 5.262697 , 5.2925773, 5.274788 , 5.2541804,
       5.285217 , 5.265981 , 5.245502 , 5.302911 , 5.2635846, 5.300912 ,
       5.2540054, 5.293143 , 5.2632456, 5.261222 , 5.2712383, 5.296694 ,
       5.257828 , 5.27427  , 5.290226 , 5.2914395, 5.298017 , 5.2574525,
       5.2437935, 5.288969 , 5.3045654, 5.2521152, 5.30147  , 5.2512307,
       5.2580795, 5.244114 , 5.2593155, 5.251976 , 5.2924533, 5.2743273,
       5.2552996, 5.2722406, 5.2654943, 5.2661786, 5.275599 , 5.266692 ,
       5.2505465, 5.304631 , 5.295239 , 5.250705 , 5.25749  , 5.289774 ,
       5.3098326, 5.303542 , 5.289889 , 5.301006 , 5.2866063, 5.275174 ,
       5.2621326, 5.270814 , 5.3083363, 5.265199 , 5.260355 , 5.3058963,
       5.284075 , 5.2575355, 5.3033853, 5.29075  ]

    fig, ax = plt.subplots(1,1, figsize=(6,5))
    n, bins, patches = ax.hist(B_ganned2, 80, range = [5.15,5.4], histtype='step', alpha=1, color='k', linewidth = 1.6, label=r'$B_0$ mass')
    ax.set_xlabel(r'$B_0$ mass [GeV]', fontsize=11)
    ax.set_ylabel('Counts', fontsize=11)
    ax.set_xlim([5.15,5.4])
    bins = bins[:-1]
    bins = bins + (bins[2] - bins[1])

    ax.ticklabel_format(axis='y',style="sci", scilimits=(0,0))

    A_opt, u_opt, sigma_opt = gauss_genetic_optimization(bins, n)
    print("Differential optimization:")
    print("A: ",A_opt,", mean: ", u_opt,", sigma: ", sigma_opt)
    print("Maximum likelihood: ", np.mean(data_arr))
    X_opt = np.linspace(5.,5.6,501)
    Y_opt = [ gauss(x_point, A_opt, u_opt, sigma_opt) for x_point in X_opt]
    ax.plot(X_opt, Y_opt, 'r', label = "DE-optimized fit", linewidth = 2)
    ax.tick_params(axis='x', labelsize=11)
    ax.tick_params(axis='y', labelsize=11)
    #leg = ax.legend(loc = 'upper left', fontsize  = 9)
    leg = ax.legend(loc = 'upper left', fontsize=11)

    plt.show()

    B_ganned3 = [5.264779 , 5.2598853, 5.290246 , 5.2642474, 5.2816744, 5.2807407,
       5.2886095, 5.2633743, 5.270123 , 5.2648907, 5.2750883, 5.2675986,
       5.2894397, 5.2634363, 5.2633657, 5.261215 , 5.26035  , 5.2968187,
       5.290779 , 5.256927 , 5.2925205, 5.2545156, 5.248561 , 5.288432 ,
       5.2617736, 5.2705407, 5.2903957, 5.262028 , 5.262747 , 5.268461 ,
       5.2958527, 5.2642894, 5.256508 , 5.303078 , 5.272704 , 5.2848854,
       5.289833 , 5.258216 , 5.269611 , 5.2936263, 5.26439  , 5.3028646,
       5.276041 , 5.2612195, 5.263545 , 5.276205 , 5.3030324, 5.259156 ,
       5.274581 , 5.2723823, 5.284468 , 5.2735295, 5.271243 , 5.2638903,
       5.2903457, 5.2895145, 5.2782507, 5.268451 , 5.284511 , 5.2557883,
       5.2618284, 5.302222 , 5.2557626, 5.274677 , 5.297268 , 5.268624 ,
       5.266659 , 5.2895465, 5.25955  , 5.2642374, 5.2844267, 5.2602277,
       5.3167667, 5.293297 , 5.299568 , 5.255346 , 5.2824035, 5.2987723,
       5.28082  , 5.262094 , 5.293006 , 5.278248 , 5.2938294, 5.25603  ,
       5.2724414, 5.268512 , 5.266955 , 5.297757 , 5.263383 , 5.2798185,
       5.2623715, 5.297393 , 5.2633343, 5.308856 , 5.2908072, 5.2827673,
       5.276164 , 5.2606916, 5.297737 , 5.2751737, 5.261791 , 5.307157 ,
       5.280462 , 5.282015 , 5.2897534, 5.2787375, 5.2646627, 5.265772 ,
       5.26349  , 5.297627 , 5.2694097, 5.297244 , 5.252381 , 5.290359 ,
       5.2891493, 5.278835 , 5.305005 , 5.2635274, 5.25641  , 5.2524223,
       5.3056316, 5.2933006, 5.287265 , 5.2966814, 5.2713833, 5.2590456,
       5.286505 , 5.2639384, 5.2669516, 5.269685 , 5.3074803, 5.278415 ,
       5.303963 , 5.2670302, 5.3010364, 5.261471 , 5.283913 , 5.2918644,
       5.296752 , 5.275208 , 5.2622714, 5.307676 , 5.259647 , 5.3022785,
       5.2878275, 5.268593 , 5.2646437, 5.299636 , 5.256107 , 5.311383 ,
       5.2682076, 5.2806683, 5.2888446, 5.297507 , 5.2623057, 5.2784467,
       5.284171 , 5.29366  , 5.2674975, 5.2699127, 5.2913685, 5.2926116,
       5.261985 , 5.305476 , 5.3258877, 5.2804236, 5.2717767, 5.269883 ,
       5.3042135, 5.262683 , 5.2708726, 5.2646575, 5.2590857, 5.2749076,
       5.258652 , 5.2645454, 5.2860575, 5.304474 , 5.2843337, 5.3062816,
       5.2989063, 5.2524433, 5.2664533, 5.2871194, 5.2814393, 5.2786617,
       5.265301 , 5.287213 , 5.2715993, 5.263671 , 5.3059635, 5.292208 ,
       5.307323 , 5.3158293, 5.26665  , 5.279724 , 5.298884 , 5.289088 ,
       5.275911 , 5.25362  , 5.2696466, 5.2552485, 5.2803874, 5.288008 ,
       5.268996 , 5.27911  , 5.2616043, 5.2876797, 5.2989154, 5.2693095,
       5.25835  , 5.2608137, 5.265233 , 5.261391 , 5.263261 , 5.2869997,
       5.293342 , 5.260974 , 5.299153 , 5.2670193, 5.2587   , 5.280132 ,
       5.2780943, 5.3023157, 5.2637787, 5.275996 , 5.2637777, 5.263892 ,
       5.3082957, 5.279065 , 5.2633343, 5.258337 , 5.304966 , 5.26165  ,
       5.271579 , 5.2580233, 5.294214 , 5.2799797, 5.2819166, 5.2713623,
       5.257532 , 5.2650156, 5.302511 , 5.26223  , 5.3031225, 5.2907424,
       5.322126 , 5.269229 , 5.2877617, 5.2593594, 5.265658 , 5.258488 ,
       5.29293  , 5.2569265, 5.2720203, 5.276076 , 5.2600713, 5.2885094,
       5.2669005, 5.2614045, 5.2807684, 5.2644777, 5.274422 , 5.2879734,
       5.2645717, 5.251181 , 5.268831 , 5.2941027, 5.262474 , 5.264848 ,
       5.2575808, 5.2696476, 5.2626753, 5.2626057, 5.26981  , 5.2713904,
       5.2878256, 5.2979803, 5.2573347, 5.259005 , 5.293429 , 5.278149 ,
       5.2975125, 5.2668667, 5.2803955, 5.300086 , 5.2636485, 5.2574263,
       5.2918077, 5.2845783, 5.285515 , 5.2564206, 5.294078 , 5.2641983,
       5.272064 , 5.282364 , 5.275762 , 5.2892056, 5.268924 , 5.2658567,
       5.2567863, 5.263429 , 5.2871733, 5.2700486, 5.2791147, 5.2766547,
       5.3053327, 5.2767158, 5.257366 , 5.281101 , 5.2665496, 5.273102 ,
       5.2878704, 5.2627406, 5.277848 , 5.2608347, 5.2684636, 5.2705173,
       5.2571435, 5.271473 , 5.2652025, 5.286345 , 5.291395 , 5.259274 ,
       5.2579126, 5.295477 , 5.292789 , 5.276053 , 5.278155 , 5.2576604,
       5.2937346, 5.2979126, 5.2640715, 5.2628117, 5.2793016, 5.2967577,
       5.25705  , 5.2583385, 5.276672 , 5.2760234, 5.271407 , 5.261883 ,
       5.3016787, 5.2624326, 5.2711806, 5.2949977, 5.2634373, 5.3044453,
       5.2581177, 5.255275 , 5.2826076, 5.2898254, 5.301895 , 5.2828   ,
       5.2954063, 5.3031197, 5.256814 , 5.2814245, 5.303379 , 5.2656226,
       5.2975492, 5.2764583, 5.292048 , 5.2584434, 5.292941 , 5.2769923,
       5.264827 , 5.3012376, 5.2907286, 5.259978 , 5.269825 , 5.2653456,
       5.2931767, 5.2503877, 5.2957473, 5.2986755, 5.2865596, 5.3020363,
       5.268028 , 5.2670317, 5.2648478, 5.2838917, 5.261308 , 5.273442 ,
       5.281485 , 5.2957377, 5.269276 , 5.263533 , 5.267979 , 5.2745905,
       5.262526 , 5.326295 , 5.3012314, 5.2945046, 5.289323 , 5.264843 ,
       5.2730904, 5.303574 , 5.2564883, 5.2662153, 5.2665825, 5.2678213,
       5.3008795, 5.298636 , 5.3090725, 5.2598653, 5.3096275, 5.269945 ,
       5.2761736, 5.2698503, 5.267633 , 5.2677402, 5.2699137, 5.3013625,
       5.288453 , 5.270258 , 5.2614493, 5.26238  , 5.262086 , 5.3147564,
       5.300175 , 5.2878075, 5.275795 , 5.2931695, 5.2672205, 5.2985625,
       5.279348 , 5.260144 , 5.2713165, 5.2883077, 5.2716017, 5.258942 ,
       5.312769 , 5.2649727, 5.2663307, 5.27198  , 5.2489576, 5.259218 ,
       5.261803 , 5.2658634, 5.2853894, 5.287663 , 5.25341  , 5.2888627,
       5.266069 , 5.2634625, 5.267651 , 5.2638764, 5.2613974, 5.28375  ,
       5.268035 , 5.263324 , 5.264432 , 5.2931085, 5.297477 , 5.2887735,
       5.257188 , 5.312776 , 5.2612653, 5.2744656, 5.289802 , 5.280286 ,
       5.319238 , 5.2651095, 5.2959523, 5.2698164, 5.2831244, 5.3079195,
       5.2803073, 5.2613373, 5.279842 , 5.2660947, 5.2564363, 5.270891 ,
       5.321957 , 5.257234 , 5.2739725, 5.268312 , 5.2947226, 5.266613 ,
       5.2930503, 5.2648435, 5.2690563, 5.256761 , 5.2591224, 5.299358 ,
       5.25608  , 5.2877307, 5.2581167, 5.2773046, 5.274162 , 5.3054504,
       5.2536235, 5.3140306, 5.270867 , 5.28406  , 5.2688985, 5.2940917,
       5.302518 , 5.2533216, 5.283408 , 5.2764287, 5.259385 , 5.2597923,
       5.25537  , 5.2917604, 5.2549443, 5.268152 , 5.254018 , 5.2610226,
       5.303662 , 5.2711716, 5.2699   , 5.252433 , 5.260658 , 5.311889 ,
       5.301728 , 5.273396 , 5.2614884, 5.283498 , 5.301679 , 5.2689924,
       5.2612414, 5.271008 , 5.2685947, 5.2980227, 5.2766643, 5.276013 ,
       5.258843 , 5.273535 , 5.2930374, 5.292752 , 5.260639 , 5.2847514,
       5.2894883, 5.2938704, 5.27514  , 5.2905955, 5.2688613, 5.2633457,
       5.251519 , 5.293977 , 5.300202 , 5.2723904, 5.2703977, 5.267032 ,
       5.2654467, 5.252754 , 5.2776895, 5.258396 , 5.277382 , 5.32793  ,
       5.266504 , 5.269306 , 5.2578816, 5.265874 , 5.3216395, 5.2555857,
       5.3025527, 5.266416 , 5.295992 , 5.2690907, 5.27284  , 5.297549 ,
       5.265488 , 5.2608056, 5.281626 , 5.290707 , 5.2655244, 5.274178 ,
       5.2684937, 5.2944107, 5.2912993, 5.293712 , 5.280686 , 5.2945743,
       5.2644167, 5.2645864, 5.264281 , 5.248117 , 5.25896  , 5.298724 ,
       5.3083777, 5.2683897, 5.2861834, 5.297842 , 5.2932262, 5.248255 ,
       5.268746 , 5.2629724, 5.2578106, 5.2846904, 5.2699084, 5.2628345,
       5.2653675, 5.2984886, 5.270826 , 5.2748656, 5.2553673, 5.2955317,
       5.2921424, 5.2797666, 5.260553 , 5.2744904, 5.2738485, 5.269037 ,
       5.2657027, 5.2621837, 5.281201 , 5.275828 , 5.2826986, 5.262496 ,
       5.252162 , 5.2741218, 5.2683506, 5.2940793, 5.288751 , 5.2873507,
       5.263246 , 5.258882 , 5.306717 , 5.289091 , 5.2495246, 5.3027773,
       5.2898054, 5.2944655, 5.2589164, 5.269469 , 5.2877493, 5.286473 ,
       5.2833023, 5.2780647, 5.2609186, 5.2775893, 5.2618117, 5.2699676,
       5.3197374, 5.303335 , 5.280442 , 5.2677054, 5.2650394, 5.2680244,
       5.257984 , 5.2648454, 5.260902 , 5.295663 , 5.3053107, 5.2977185,
       5.289904 , 5.2899013, 5.277868 , 5.264386 , 5.2757893, 5.241192 ,
       5.264089 , 5.267153 , 5.2800655, 5.257375 , 5.2617025, 5.273777 ,
       5.2634873, 5.2787666, 5.2833204, 5.3051667, 5.2676487, 5.251651 ,
       5.269746 , 5.260025 , 5.261999 , 5.289045 , 5.285056 , 5.257667 ,
       5.2617702, 5.250581 , 5.2710705, 5.30707  , 5.295409 , 5.2635374,
       5.28103  , 5.2806044, 5.271032 , 5.264664 , 5.258177 , 5.26484  ,
       5.293601 , 5.304985 , 5.2668514, 5.2644434, 5.2852106, 5.29857  ,
       5.2572994, 5.2932997, 5.295587 , 5.2972684, 5.2749977, 5.266688 ,
       5.2579722, 5.2628   , 5.27715  , 5.2956357, 5.2880397, 5.293644 ,
       5.2610145, 5.2640324, 5.2580123, 5.2881227, 5.2679152, 5.322394 ,
       5.265806 , 5.29537  , 5.2963686, 5.261118 , 5.2837496, 5.272029 ,
       5.2666144, 5.2550755, 5.294592 , 5.2652974, 5.272751 , 5.2619267,
       5.285548 , 5.2659755, 5.258348 , 5.267689 , 5.2787123, 5.2916465,
       5.2922297, 5.24145  , 5.2889977, 5.276397 , 5.2630177, 5.2853494,
       5.295463 , 5.2925906, 5.264129 , 5.275173 , 5.24778  , 5.2782845,
       5.252711 , 5.263947 , 5.268994 , 5.285993 , 5.2907224, 5.294157 ,
       5.2599096, 5.29222  , 5.2855434, 5.2876487, 5.2931075, 5.263696 ,
       5.260987 , 5.299617 , 5.2671523, 5.291233 , 5.2811313, 5.2590046,
       5.2672577, 5.2833557, 5.255375 , 5.2816243, 5.3009224, 5.2992225,
       5.2670755, 5.2687817, 5.2948403, 5.303457 , 5.2770553, 5.2665606,
       5.2608447, 5.2745876, 5.270869 , 5.279309 , 5.316534 , 5.2957973,
       5.26687  , 5.2600684, 5.3137164, 5.292121 , 5.265215 , 5.2843456,
       5.263806 , 5.262278 , 5.2682486, 5.258224 , 5.261875 , 5.2804847,
       5.2687454, 5.3045177, 5.2629066, 5.314271 , 5.273094 , 5.274682 ,
       5.272608 , 5.25555  , 5.258386 , 5.263539 , 5.2825475, 5.2619166,
       5.2948613, 5.2860684, 5.2635508, 5.274489 , 5.2932954, 5.316888 ,
       5.2810664, 5.270124 , 5.3084483, 5.271165 , 5.286116 , 5.2627044,
       5.2613673, 5.2696486, 5.2644124, 5.29592  , 5.290545 , 5.298861 ,
       5.301676 , 5.281719 , 5.269345 , 5.288409 , 5.2709966, 5.272921 ,
       5.2592463, 5.2794766, 5.295241 , 5.286389 , 5.2807336, 5.2899957,
       5.3067045, 5.260051 , 5.2697487, 5.259083 , 5.2640452, 5.277054 ,
       5.2620845, 5.260771 , 5.2761517, 5.284432 , 5.2841544, 5.279702 ,
       5.290587 , 5.256295 , 5.3237276, 5.250391 , 5.2705464, 5.305169 ,
       5.2673955, 5.292519 , 5.264399 , 5.298743 , 5.3037376, 5.2642703,
       5.2758255, 5.29701  , 5.257738 , 5.2685466, 5.2945123, 5.2654166,
       5.267512 , 5.2658463, 5.3042884, 5.258663 , 5.294481 , 5.278601 ,
       5.2878304, 5.2653413, 5.2626514, 5.2902107, 5.268737 , 5.279696 ,
       5.2605906, 5.276093 , 5.257209 , 5.256949 , 5.2851696, 5.299287 ,
       5.2939034, 5.260079 , 5.295952 , 5.2604594, 5.297939 , 5.257498 ,
       5.2509484, 5.2688723, 5.2931786, 5.278993 , 5.252642 , 5.285185 ,
       5.289651 , 5.2938867, 5.257501 , 5.2928085, 5.2783613, 5.2903748,
       5.2621093, 5.262167 , 5.2930965, 5.2735476, 5.277957 , 5.259667 ,
       5.275428 , 5.2745066, 5.2861905, 5.259036 , 5.2541595, 5.266246 ,
       5.289031 , 5.254697 , 5.291235 , 5.258392 , 5.2606025, 5.253993 ,
       5.318612 , 5.292436 , 5.2688813, 5.277354 , 5.2711225, 5.2603927,
       5.2919645, 5.2717166, 5.267893 , 5.2680397, 5.2855783, 5.270568 ,
       5.254468 , 5.2800493, 5.250717 , 5.272082 , 5.2813983, 5.259467 ,
       5.3009663, 5.2845464, 5.2848277, 5.249442 , 5.303046 , 5.287387 ,
       5.26235  , 5.29204  , 5.272799 , 5.2862153, 5.292565 , 5.2899117,
       5.299822 , 5.293992 , 5.260999 , 5.2884116, 5.2587376, 5.2710114,
       5.261541 , 5.26981  , 5.2634597, 5.262341 , 5.25668  , 5.2879252,
       5.27236  , 5.262192 , 5.2727184, 5.295021 , 5.264403 , 5.2726398,
       5.2537713, 5.2525916, 5.2639194, 5.2860026, 5.270407 , 5.286817 ,
       5.257898 , 5.2840285, 5.25471  , 5.2814198, 5.2611313, 5.288648 ,
       5.300197 , 5.2601185, 5.2539654, 5.2947145, 5.2524986, 5.2978306,
       5.2623243, 5.2575502, 5.252143 , 5.292224 , 5.2599344, 5.2850623,
       5.3039756, 5.2883654, 5.282426 , 5.260497 , 5.277074 , 5.302057 ,
       5.2572007, 5.263233 , 5.263911 , 5.2686515, 5.257245 , 5.2869534,
       5.2638006, 5.2810745, 5.286136 , 5.2537527]

    fig, ax = plt.subplots(1,1, figsize=(6,5))
    n, bins, patches = ax.hist(B_ganned3, 80, range = [5.15,5.4], histtype='step', alpha=1, color='k', linewidth = 1.6, label=r'$B_0$ mass')
    ax.set_xlabel(r'$B_0$ mass [GeV]', fontsize=11)
    ax.set_ylabel('Counts', fontsize=11)
    ax.set_xlim([5.15,5.4])
    bins = bins[:-1]
    bins = bins + (bins[2] - bins[1])

    ax.ticklabel_format(axis='y',style="sci", scilimits=(0,0))

    A_opt, u_opt, sigma_opt = gauss_genetic_optimization(bins, n)
    print("Differential optimization:")
    print("A: ",A_opt,", mean: ", u_opt,", sigma: ", sigma_opt)
    print("Maximum likelihood: ", np.mean(data_arr))
    X_opt = np.linspace(5.,5.6,501)
    Y_opt = [ gauss(x_point, A_opt, u_opt, sigma_opt) for x_point in X_opt]
    ax.plot(X_opt, Y_opt, 'r', label = "DE-optimized fit", linewidth = 2)
    ax.tick_params(axis='x', labelsize=11)
    ax.tick_params(axis='y', labelsize=11)
    #leg = ax.legend(loc = 'upper left', fontsize  = 9)
    leg = ax.legend(loc = 'upper left', fontsize=11)

    plt.show()

    B_ganned4 =[5.288475 , 5.2908745, 5.292952 , 5.289798 , 5.3040767, 5.300669 ,
       5.297184 , 5.292797 , 5.2918262, 5.2907624, 5.298806 , 5.301062 ,
       5.291464 , 5.2904887, 5.2731314, 5.301597 , 5.29168  , 5.2957726,
       5.288165 , 5.282517 , 5.2940903, 5.2949553, 5.3022065, 5.292561 ,
       5.3048134, 5.2938404, 5.2931476, 5.3001475, 5.288485 , 5.2780523,
       5.2896166, 5.2872295, 5.284564 , 5.287239 , 5.2949214, 5.296941 ,
       5.295887 , 5.293274 , 5.29929  , 5.2994785, 5.2872834, 5.2789564,
       5.297243 , 5.2897606, 5.2992415, 5.2891226, 5.281823 , 5.2840405,
       5.291768 , 5.299251 , 5.2922163, 5.292866 , 5.2906623, 5.2912464,
       5.2978015, 5.299427 , 5.286816 , 5.285954 , 5.2727857, 5.2795777,
       5.2966423, 5.2945786, 5.290862 , 5.2919703, 5.2886863, 5.288399 ,
       5.2905583, 5.2788324, 5.29069  , 5.2893357, 5.294094 , 5.2951374,
       5.2883563, 5.293882 , 5.290811 , 5.301311 , 5.2914405, 5.293283 ,
       5.293126 , 5.2936077, 5.2852516, 5.299265 , 5.294282 , 5.294721 ,
       5.26545  , 5.28012  , 5.294937 , 5.3019667, 5.301342 , 5.2941256,
       5.286289 , 5.292287 , 5.2938237, 5.2898507, 5.2985415, 5.297795 ,
       5.2977586, 5.2898993, 5.2924814, 5.3011804, 5.2903943, 5.288152 ,
       5.286584 , 5.2917714, 5.296436 , 5.291861 , 5.287053 , 5.296569 ,
       5.296762 , 5.2883673, 5.297767 , 5.289936 , 5.299116 , 5.2946095,
       5.2888894, 5.289439 , 5.299881 , 5.3014545, 5.278184 , 5.2890673,
       5.289716 , 5.298989 , 5.285781 , 5.2876906, 5.2875285, 5.294105 ,
       5.2964344, 5.2943935, 5.302769 , 5.29442  , 5.2866554, 5.2997413,
       5.291493 , 5.2996554, 5.286545 , 5.2938557, 5.289712 , 5.2949114,
       5.29721  , 5.3043056, 5.2997475, 5.2912483, 5.2835054, 5.2919455,
       5.2929835, 5.290942 , 5.2899947, 5.2935476, 5.29562  , 5.2924113,
       5.2907486, 5.2975206, 5.297335 , 5.2931776, 5.2912073, 5.281438 ,
       5.302189 , 5.290636 , 5.292105 , 5.2900157, 5.2949905, 5.2969475,
       5.2936625, 5.2898808, 5.3030624, 5.294508 , 5.2921343, 5.2952943,
       5.3031735, 5.2889686, 5.297373 , 5.297614 , 5.2914567, 5.294923 ,
       5.301976 , 5.296541 , 5.2906857, 5.2829328, 5.3031974, 5.302976 ,
       5.2971897, 5.287127 , 5.299592 , 5.29933  , 5.3011603, 5.2912555,
       5.3052573, 5.29355  , 5.283156 , 5.296614 , 5.286153 , 5.2911034,
       5.290406 , 5.2926693, 5.286164 , 5.2913904, 5.2869534, 5.285338 ,
       5.2912674, 5.2932115, 5.296611 , 5.2915583, 5.29513  , 5.2939987,
       5.2922125, 5.2931747, 5.2931585, 5.289712 , 5.2920814, 5.300089 ,
       5.3020306, 5.2896624, 5.296438 , 5.291091 , 5.282342 , 5.302824 ,
       5.301543 , 5.2896867, 5.2891607, 5.289125 , 5.2932315, 5.291639 ,
       5.298858 , 5.2865944, 5.2894015, 5.292441 , 5.295748 , 5.281158 ,
       5.2904887, 5.280365 , 5.2873316, 5.2988653, 5.2959976, 5.2907696,
       5.2922034, 5.286625 , 5.294926 , 5.2911434, 5.2644386, 5.282952 ,
       5.2939606, 5.2924767, 5.285635 , 5.2909646, 5.296284 , 5.288707 ,
       5.2874894, 5.288544 , 5.2910476, 5.2891197, 5.292781 , 5.301376 ,
       5.2910075, 5.301799 , 5.303243 , 5.288215 , 5.2942443, 5.296102 ,
       5.2880445, 5.2940927, 5.2977777, 5.2987432, 5.2967596, 5.2831635,
       5.293886 , 5.294851 , 5.29464  , 5.269838 , 5.2916813, 5.295539 ,
       5.2914515, 5.2842126, 5.29126  , 5.3012986, 5.3050723, 5.298926 ,
       5.30374  , 5.3011956, 5.29014  , 5.2926598, 5.300381 , 5.2877464,
       5.2928696, 5.290565 , 5.287804 , 5.289566 , 5.2820697, 5.295078 ,
       5.283404 , 5.2882953, 5.298407 , 5.315348 , 5.2937574, 5.2913375,
       5.295802 , 5.2931113, 5.287451 , 5.288542 , 5.2896237, 5.2901177,
       5.3023453, 5.298678 , 5.2870803, 5.2986984, 5.2942195, 5.2972684,
       5.295332 , 5.295157 , 5.295242 , 5.292775 , 5.302376 , 5.2858214,
       5.2930775, 5.296628 , 5.2929797, 5.2976904, 5.2958975, 5.2929926,
       5.2813306, 5.287747 , 5.3006153, 5.30337  , 5.3010626, 5.290306 ,
       5.3038993, 5.2929926, 5.308437 , 5.292884 , 5.2915397, 5.2906632,
       5.2933025, 5.280586 , 5.301505 , 5.2787404, 5.294058 , 5.279659 ,
       5.2938066, 5.2910495, 5.2933145, 5.291438 , 5.2975955, 5.2904463,
       5.29586  , 5.2937098, 5.2986746, 5.2975054, 5.2914658, 5.294122 ,
       5.2912025, 5.2816296, 5.2926006, 5.292637 , 5.2863264, 5.292862 ,
       5.292298 , 5.2949724, 5.3048654, 5.301697 , 5.2946815, 5.3011217,
       5.289999 , 5.293704 , 5.2986784, 5.2920146, 5.2911687, 5.303772 ,
       5.2885466, 5.296675 , 5.3096514, 5.2871647, 5.293323 , 5.288802 ,
       5.295698 , 5.28758  , 5.2848334, 5.2880006, 5.299534 , 5.2982078,
       5.27765  , 5.295545 , 5.290884 , 5.290221 , 5.2952847, 5.292829 ,
       5.3025956, 5.300603 , 5.283426 , 5.2994676, 5.276292 , 5.264392 ,
       5.2734246, 5.2980504, 5.2875447, 5.2931848, 5.2946615, 5.290405 ,
       5.296027 , 5.282981 , 5.3032217, 5.291449 , 5.2929177, 5.2937694,
       5.290436 , 5.2903247, 5.2805433, 5.289834 , 5.297541 , 5.2774367,
       5.2945685, 5.298232 , 5.281113 , 5.29376  , 5.283959 , 5.2873154,
       5.300585 , 5.301812 , 5.2964473, 5.294824 , 5.2983537, 5.2957044,
       5.289588 , 5.3027363, 5.2956705, 5.2922745, 5.285904 , 5.284566 ,
       5.293253 , 5.2863836, 5.27978  , 5.299232 , 5.297844 , 5.3036437,
       5.299538 , 5.2886677, 5.297728 , 5.2968473, 5.2946777, 5.2998824,
       5.2911525, 5.288112 , 5.280207 , 5.2993603, 5.306958 , 5.2996736,
       5.2901587, 5.2965145, 5.290281 , 5.291952 , 5.2994056, 5.29156  ,
       5.2892957, 5.290541 , 5.289787 , 5.2828994, 5.291585 , 5.2927876,
       5.288278 , 5.306406 , 5.29396  , 5.304533 , 5.2909365, 5.289735 ,
       5.2934294, 5.278952 , 5.295042 , 5.2976427, 5.298026 , 5.2955604,
       5.2909055, 5.2968607, 5.2837315, 5.300073 , 5.291095 , 5.291632 ,
       5.274931 , 5.308262 , 5.2981424, 5.27455  , 5.2961183, 5.292825 ,
       5.2782884, 5.2939477, 5.2949877, 5.2907076, 5.2826567, 5.2757792,
       5.29526  , 5.296646 , 5.2957573, 5.298011 , 5.3008857, 5.2860928,
       5.2904577, 5.288323 , 5.293236 , 5.28914  , 5.2872024, 5.2857084,
       5.291186 , 5.303175 , 5.2884474, 5.28143  , 5.2954555, 5.292844 ,
       5.29836  , 5.3040156, 5.2882075, 5.290633 , 5.297372 , 5.2897162,
       5.294467 , 5.3018594, 5.2679462, 5.2950125, 5.30305  , 5.291258 ,
       5.2973614, 5.294094 , 5.3057017, 5.2933836, 5.294992 , 5.3031344,
       5.293625 , 5.2967067, 5.2979097, 5.293338 , 5.301976 , 5.2681527,
       5.2895184, 5.285504 , 5.280921 , 5.3011155, 5.284222 , 5.2924113,
       5.3002324, 5.295717 , 5.2974873, 5.292591 , 5.2942514, 5.294162 ,
       5.301448 , 5.292279 , 5.2664   , 5.300061 , 5.307393 , 5.2908683,
       5.2673297, 5.2964554, 5.297715 , 5.29176  , 5.2702627, 5.285293 ,
       5.2876496, 5.2948947, 5.2969913, 5.295355 , 5.2883363, 5.2913756,
       5.2905946, 5.2938423, 5.291021 , 5.292648 , 5.2975945, 5.3089275,
       5.2991486, 5.2978787, 5.2919507, 5.289859 , 5.3029814, 5.2897105,
       5.2882195, 5.292023 , 5.299472 , 5.297074 , 5.298344 , 5.291042 ,
       5.2938933, 5.292851 , 5.2925587, 5.29109  , 5.260235 , 5.292819 ,
       5.298506 , 5.2919297, 5.2902293, 5.2911263, 5.2916226, 5.296274 ,
       5.292933 , 5.2894287, 5.2684293, 5.2786508, 5.266403 , 5.2962646,
       5.295652 , 5.293199 , 5.2991714, 5.282995 , 5.296976 , 5.2990894,
       5.298326 , 5.2923064, 5.2917943, 5.2913785, 5.2814436, 5.2921696,
       5.297577 , 5.290196 , 5.2952223, 5.2940536, 5.284181 , 5.290563 ,
       5.297527 , 5.2961674, 5.29729  , 5.2906446, 5.2960386, 5.295971 ,
       5.2910113, 5.2908254, 5.3033566, 5.3007436, 5.293338 , 5.3038664,
       5.295135 , 5.293261 , 5.289057 , 5.289646 , 5.2912927, 5.286244 ,
       5.296893 , 5.289481 , 5.2845993, 5.3025146, 5.294851 , 5.298738 ,
       5.2939687, 5.3006883, 5.294277 , 5.2796   , 5.3010726, 5.2905126,
       5.2989483, 5.2913537, 5.2829437, 5.2968125, 5.2946453, 5.287776 ,
       5.304597 , 5.2921886, 5.286762 , 5.2868724, 5.2895193, 5.2901077,
       5.302924 , 5.2911196, 5.2905526, 5.289211 , 5.284293 , 5.2978535,
       5.297499 , 5.2930317, 5.301986 , 5.2811966, 5.284663 , 5.294316 ,
       5.292334 , 5.2890363, 5.2921476, 5.288786 , 5.3044753, 5.2938833,
       5.2874117, 5.2949657, 5.2865314, 5.273402 , 5.298342 , 5.303392 ,
       5.2875977, 5.2788672, 5.290218 , 5.2959023, 5.295873 , 5.288014 ,
       5.2855935, 5.2976546, 5.2991896, 5.2915382, 5.2936773, 5.2942376,
       5.294646 , 5.2920966, 5.2888737, 5.305566 , 5.284964 , 5.2960067,
       5.290735 , 5.290848 , 5.300291 , 5.284318 , 5.291995 , 5.2894497,
       5.291125 , 5.2941217, 5.291425 , 5.295462 , 5.2989254, 5.2892814,
       5.302242 , 5.3011045, 5.2870073, 5.303692 , 5.287416 , 5.2897525,
       5.297791 , 5.2912927, 5.303368 , 5.292264 , 5.296533 , 5.3003016,
       5.283939 , 5.2913527, 5.2892795, 5.2915287, 5.2983427, 5.28816  ,
       5.2886114, 5.299083 , 5.2774553, 5.2879057, 5.279006 , 5.2780304,
       5.2913165, 5.2862034, 5.2896748, 5.2960706, 5.2912884, 5.2914414,
       5.289295 , 5.292208 , 5.290672 , 5.2920547, 5.2904325, 5.2834816,
       5.297481 , 5.292479 , 5.290918 , 5.2832212, 5.293648 , 5.29838  ,
       5.3120213, 5.2915764, 5.29563  , 5.288218 , 5.304815 , 5.29291  ,
       5.2938833, 5.2966876, 5.29279  , 5.29037  , 5.296024 , 5.295569 ,
       5.29256  , 5.285259 , 5.288043 , 5.287629 , 5.2918935, 5.2944922,
       5.289034 , 5.290982 , 5.291803 , 5.2893944, 5.2962637, 5.294414 ,
       5.29118  , 5.298816 , 5.2928243, 5.2894506, 5.287555 , 5.2958174,
       5.29114  , 5.286948 , 5.2998157, 5.2928967, 5.3062787, 5.299813 ,
       5.294473 , 5.2904763, 5.2990546, 5.283364 , 5.289852 , 5.301954 ,
       5.298136 , 5.289353 , 5.2834454, 5.2932997, 5.295094 , 5.292545 ,
       5.2972274, 5.2944565, 5.2947435, 5.296579 , 5.291144 , 5.2925196,
       5.297083 , 5.294554 , 5.2905774, 5.297531 , 5.3024807, 5.297066 ,
       5.292449 , 5.292225 , 5.300112 , 5.2845044, 5.2913203, 5.293138 ,
       5.293852 , 5.2976522, 5.295294 , 5.2857275, 5.2738504, 5.293825 ,
       5.290121 , 5.2934012, 5.302974 , 5.2883134, 5.2907243, 5.2724824,
       5.2898746, 5.291059 , 5.2927446, 5.291952 , 5.2938514, 5.292394 ,
       5.2900295, 5.2969956, 5.2875423, 5.282561 , 5.2963343, 5.2987623,
       5.292829 , 5.29973  , 5.2922726, 5.290178 , 5.2776685, 5.29511  ,
       5.296099 , 5.2939434, 5.3008614, 5.293882 , 5.2982802, 5.287508 ,
       5.2913733, 5.2908754, 5.301646 , 5.291806 , 5.286011 , 5.2931437,
       5.296942 , 5.294695 , 5.289837 , 5.3106117, 5.2887216, 5.2981515,
       5.2970533, 5.2897654, 5.298568 , 5.296814 , 5.295738 , 5.299275 ,
       5.2441955, 5.2748346, 5.281657 , 5.2817664, 5.286026 , 5.3072834,
       5.2915816, 5.2947035, 5.292097 , 5.2865124, 5.290693 , 5.295535 ,
       5.286598 , 5.292686 , 5.29565  , 5.2916527, 5.2970514, 5.2902107,
       5.2929454, 5.294297 , 5.296263 , 5.29226  , 5.2906938, 5.2926526,
       5.3029237, 5.2903376, 5.2935014, 5.2987137, 5.293491 , 5.294067 ,
       5.300766 , 5.290568 , 5.287863 , 5.286298 , 5.296388 , 5.301412 ,
       5.2973285, 5.2796717, 5.299802 , 5.301922 , 5.294288 , 5.2909513,
       5.2905293, 5.286669 , 5.2828445, 5.2973766, 5.2871013, 5.2816467,
       5.2902927, 5.2829976, 5.294818 , 5.2938514, 5.2973704, 5.288686 ,
       5.2898264, 5.2924566, 5.299559 , 5.295569 , 5.2557216, 5.2997546,
       5.2938795, 5.2905746, 5.281626 , 5.2953634, 5.2914176, 5.2905927,
       5.29228  , 5.2978487, 5.2898026, 5.28988  , 5.2918477, 5.297852 ,
       5.2908096, 5.2856116, 5.2922063, 5.2902727, 5.2599626, 5.285986 ,
       5.2899594, 5.299545 , 5.2853403, 5.2983627, 5.2975683, 5.29377  ,
       5.2838774, 5.291771 , 5.259953 , 5.2938375, 5.2899866, 5.2899694,
       5.2911983, 5.291487 , 5.28598  , 5.295788 , 5.2931204, 5.2671027,
       5.2972035, 5.2806234, 5.2961144, 5.295653 , 5.2988234, 5.293135 ,
       5.2750206, 5.2961035, 5.2893915, 5.2946496, 5.297114 , 5.2976766,
       5.290515 , 5.278177 , 5.2918625, 5.2912908, 5.297552 , 5.2889676,
       5.300565 , 5.288892 , 5.280438 , 5.2850094, 5.2915354, 5.2962255,
       5.294812 , 5.3014193, 5.2899346, 5.297588 , 5.2922034, 5.2885523,
       5.297784 , 5.2998905, 5.301759 , 5.289236 ]

    fig, ax = plt.subplots(1,1, figsize=(6,5))
    n, bins, patches = ax.hist(B_ganned4, 80, range = [5.15,5.4], histtype='step', alpha=1, color='k', linewidth = 1.6, label=r'$B_0$ mass')
    ax.set_xlabel(r'$B_0$ mass [GeV]', fontsize=11)
    ax.set_ylabel('Counts', fontsize=11)
    ax.set_xlim([5.15,5.4])
    bins = bins[:-1]
    bins = bins + (bins[2] - bins[1])

    ax.ticklabel_format(axis='y',style="sci", scilimits=(0,0))

    A_opt, u_opt, sigma_opt = gauss_genetic_optimization(bins, n)
    print("Differential optimization:")
    print("A: ",A_opt,", mean: ", u_opt,", sigma: ", sigma_opt)
    print("Maximum likelihood: ", np.mean(data_arr))
    X_opt = np.linspace(5.,5.6,501)
    Y_opt = [ gauss(x_point, A_opt, u_opt, sigma_opt) for x_point in X_opt]
    ax.plot(X_opt, Y_opt, 'r', label = "DE-optimized fit", linewidth = 2)
    ax.tick_params(axis='x', labelsize=11)
    ax.tick_params(axis='y', labelsize=11)
    #leg = ax.legend(loc = 'upper left', fontsize  = 9)
    leg = ax.legend(loc = 'upper left', fontsize=11)

    plt.show()

if __name__ == "__main__" :
    main()
